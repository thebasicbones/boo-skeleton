"""
Pytest configuration and fixtures
"""
import pytest
from fastapi.testclient import TestClient

from main import app
{%- if database_type == 'sqlite' or database_type == 'postgresql' %}
from app.database_sqlalchemy import init_database, close_database
{%- elif database_type == 'mongodb' %}
from app.database_mongodb import init_database, close_database
{%- endif %}


@pytest.fixture(scope="session")
async def setup_database():
    """Initialize database for testing."""
    await init_database()
    yield
    await close_database()


@pytest.fixture
def client(setup_database):
    """Get test client."""
    return TestClient(app)
